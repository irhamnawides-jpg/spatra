<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daftar File Terunggah</title>
    <style>
        :root {
            --primary-color: #4f46e5;
            --bg-color: #f3f4f6;
            --text-main: #1f2937;
            --border-color: #e5e7eb;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            padding: 20px;
            color: var(--text-main);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--text-main);
        }

        /* Style untuk Tabel Google Visualization */
        .google-visualization-table {
            width: 100% !important;
            border-collapse: collapse !important;
            font-size: 14px;
        }

        /* Header Tabel */
        .google-visualization-table thead tr {
            background-color: var(--primary-color);
            color: white;
        }

        .google-visualization-table th {
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
        }

        /* Baris Data */
        .google-visualization-table tbody tr {
            border-bottom: 1px solid var(--border-color);
        }

        .google-visualization-table tbody tr:nth-child(even) {
            background-color: #f9fafb;
        }

        .google-visualization-table tbody tr:hover {
            background-color: #f3f4f6;
        }

        .google-visualization-table td {
            padding: 12px 15px;
            vertical-align: middle;
        }

        /* Tombol Link di Tabel */
        .file-link {
            color: white;
            background-color: var(--primary-color);
            padding: 6px 12px;
            text-decoration: none;
            border-radius: 4px;
            font-size: 12px;
            display: inline-block;
        }

        .file-link:hover {
            background-color: #4338ca;
        }

        /* Pagination / Footer Tabel */
        .google-visualization-table-div {
            overflow-x: auto;
        }
        
        /* Indikator Loading */
        #loading {
            text-align: center;
            padding: 20px;
            font-style: italic;
            color: #666;
        }

        /* Responsif */
        @media (max-width: 768px) {
            .container { padding: 1rem; }
            .google-visualization-table { font-size: 12px; }
            .google-visualization-table td, .google-visualization-table th { padding: 8px; }
        }
    </style>
    <!-- Load Google Charts Library -->
    <script src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>

    <div class="container">
        <h1>Data File Terunggah</h1>
        <div id="loading">Memuat data...</div>
        <div id="table_div"></div>
    </div>

    <script>
        // ==========================================
        // KONFIGURASI
        // Masukkan ID Spreadsheet Google Sheet Anda di sini
        // ==========================================
        const SPREADSHEET_ID = '13uCawLAVcKogP0WuAtiUgl_HO63dfh_NoY9wc6-zzmY';

        // Memuat library Google Visualization
        google.charts.load('current', {'packages':['table']});
        google.charts.setOnLoadCallback(drawTable);

        function drawTable() {
            var query = new google.visualization.Query(
                'https://docs.google.com/spreadsheets/d/' + SPREADSHEET_ID + '/gviz/tq?headers=1'
            );

            // Query SQL: Ambil semua kolom, urutkan berdasarkan Kolom A (Timestamp) secara DESCENDING (Terbaru diatas)
            // Kolom A=Timestamp, B=Nama, C=Email, D=Deskripsi, E=Nama File, F=Link File
            query.setQuery('SELECT A, B, C, D, E, F ORDER BY A DESC');

            query.send(handleQueryResponse);
        }

        function handleQueryResponse(response) {
            document.getElementById('loading').style.display = 'none';

            if (response.isError()) {
                alert('Error dalam query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                return;
            }

            var data = response.getDataTable();

            // Membuat DataView untuk memformat kolom Link (Kolom F)
            var view = new google.visualization.DataView(data);
            
            // Definisikan kolom: Tampilkan A s/d E, lalu format F menjadi tombol HTML
            view.setColumns([
                0, // Timestamp
                1, // Nama
                2, // Email
                3, // Deskripsi
                4, // Nama File
                {
                    calc: function (dt, row) {
                        var link = dt.getValue(row, 5); // Ambil nilai dari Kolom F
                        return '<a href="' + link + '" target="_blank" class="file-link">Buka File</a>';
                    },
                    type: 'string',
                    label: 'Aksi'
                }
            ]);

            var table = new google.visualization.Table(document.getElementById('table_div'));
            
            // Opsi Tampilan Tabel
            var options = {
                allowHtml: true, // Penting agar link HTML dirender
                showRowNumber: false,
                width: '100%',
                height: '100%',
                page: 'enable', // Aktifkan pagination
                pageSize: 10, // 10 baris per halaman
                pagingButtonsConfiguration: 'auto'
            };

            table.draw(view, options);
        }
    </script>
</body>
</html>
